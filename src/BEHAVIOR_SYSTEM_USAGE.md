# Bunny Behavior System Usage Guide

This document explains how the animated behavior system works for bunny characters on the menu screen.

## Overview

The `BunnyBehaviorSystem` creates playful, random animations and movements for bunny characters, making the magical garden menu screen feel alive and interactive.

## Features

### Random Animation Behaviors

Each bunny randomly selects from 10 different animation types:

1. **Idle** (30% weight) - Gentle breathing, ear wiggle, blinking
2. **Run Right** (15% weight) - Natural running to the right
3. **Run Left** (15% weight) - Natural running to the left (properly redrawn)
4. **Jump** (10% weight) - Cute jump with squash & stretch
5. **Dance** (12% weight) - Playful hopping, ear bouncing
6. **Victory** (8% weight) - Jumping happily with celebration
7. **Talk** (8% weight) - Mouth and head motion, blinking
8. **Sleep** (5% weight) - Curled position, breathing cycle
9. **Hit** (3% weight) - Light, child-friendly recoil
10. **Walk** (10% weight) - Slow, gentle movement

### Behavior Logic

- **Random Selection**: Behaviors are weighted, so common behaviors (idle) appear more often
- **Automatic Transitions**: Bunnies automatically switch behaviors every few seconds
- **Movement Boundaries**: Bunnies stay within the garden area (lower 30% of screen)
- **Smooth Transitions**: All movements use easing for cartoon-like feel

### Interactive Features

- **Click Interaction**: Clicking a bunny triggers a special reaction (victory, jump, or dance)
- **Gentle Floating**: All bunnies have a subtle floating animation
- **Personality**: Each character maintains their unique colors and accessories

## Usage

### Basic Setup

The system is automatically integrated into MenuScene. Bunnies are created with:

```javascript
const bunny = createAnimatedMenuBunny(scene, x, y, charConfig);
```

### Manual Creation

If you want to create a bunny with behavior system manually:

```javascript
// Create sprite
const bunny = scene.add.sprite(400, 300, 'bunny_milo_idle_sheet', 0);

// Create behavior system
const behaviorSystem = new BunnyBehaviorSystem(scene, bunny, BUNNY_CHARACTERS.milo);
```

### Customizing Behaviors

You can customize behavior weights:

```javascript
const behaviorSystem = new BunnyBehaviorSystem(scene, bunny, charConfig);

// Change weights (higher = more likely)
behaviorSystem.behaviorWeights = {
    'idle': 40,      // More idle time
    'dance': 20,     // More dancing
    'jump': 5,       // Less jumping
    // ... etc
};
```

### Behavior Methods

Each behavior has its own method you can call directly:

```javascript
behaviorSystem.doIdle();
behaviorSystem.doRun('runright');
behaviorSystem.doJump();
behaviorSystem.doDance();
behaviorSystem.doVictory();
behaviorSystem.doTalk();
behaviorSystem.doSleep();
behaviorSystem.doHit();
behaviorSystem.doWalk();
```

### Animation Integration

The system automatically uses the sprite sheet animations generated by `BunnyAnimationGenerator`:

- Checks if animations exist before playing
- Falls back to texture if animation not available
- Handles animation completion events
- Manages animation loops

## Behavior Details

### Idle Behavior
- Duration: 3-6 seconds
- Animation: Idle (breathing, blinking, ear wiggle)
- Movement: None
- Next: Random behavior

### Run Behavior
- Duration: Based on distance (1-2 seconds)
- Animation: Run Right or Run Left
- Movement: Moves 50-150 pixels in direction
- Next: Idle or random behavior

### Jump Behavior
- Duration: ~600ms (one-shot)
- Animation: Jump (squash & stretch)
- Movement: Jumps 30-80 pixels forward, 40 pixels up
- Next: Returns to idle, then random behavior

### Dance Behavior
- Duration: 2-4 seconds
- Animation: Dance (hopping, ear flapping)
- Movement: Slight bouncing in place, rotation
- Next: Random behavior

### Victory Behavior
- Duration: 2-3 seconds
- Animation: Victory (jumping happily)
- Movement: Jumps up with scale effect
- Next: Random behavior

### Talk Behavior
- Duration: 2-3.5 seconds
- Animation: Talk (mouth movement)
- Movement: Slight head bob
- Next: Random behavior

### Sleep Behavior
- Duration: 4-8 seconds
- Animation: Sleep (curled, breathing)
- Movement: Gentle breathing scale effect
- Next: Random behavior

### Hit Behavior
- Duration: ~300ms (one-shot)
- Animation: Hit (recoil)
- Movement: Quick shake
- Next: Returns to idle, then random behavior

### Walk Behavior
- Duration: Based on distance (1.5-2 seconds)
- Animation: Run Right or Run Left (slower)
- Movement: Moves 30-80 pixels slowly
- Next: Random behavior

## Integration with Menu Scene

The MenuScene automatically:

1. Generates all bunny animations on create
2. Creates 4 bunnies with behavior systems
3. Positions them randomly in the garden area
4. Cleans up behavior systems on scene shutdown

## Performance Considerations

- Behavior timers are automatically cleaned up
- Tweens are managed by Phaser
- Animations are cached after first generation
- System is lightweight and efficient

## Customization Tips

1. **Adjust Weights**: Change `behaviorWeights` to make bunnies more or less active
2. **Add Behaviors**: Extend `BunnyBehaviorSystem` to add custom behaviors
3. **Change Durations**: Modify duration ranges in behavior methods
4. **Movement Bounds**: Adjust garden boundaries in movement methods
5. **Scale**: Change bunny scale in `createAnimatedMenuBunny`

## Example: Custom Behavior

```javascript
// Add a new "wave" behavior
BunnyBehaviorSystem.prototype.doWave = function() {
    this.playAnimation('waving');
    this.isMoving = false;
    
    // Wave animation
    this.scene.tweens.add({
        targets: this.bunny,
        angle: 15,
        duration: 200,
        yoyo: true,
        repeat: 3,
        ease: 'Sine.easeInOut'
    });
    
    this.behaviorTimer = this.scene.time.delayedCall(1500, () => {
        this.bunny.setAngle(0);
        this.selectRandomBehavior();
    });
};

// Add to available animations
behaviorSystem.availableAnimations.push('wave');
behaviorSystem.behaviorWeights['wave'] = 10;
```

## Notes

- All animations maintain consistent art style
- Bunnies stay within garden bounds automatically
- Click interactions provide immediate feedback
- System is designed for magical, playful atmosphere
- Perfect for children's educational game

